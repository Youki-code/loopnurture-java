---
description: 
globs: 
alwaysApply: true
---
# 单元测试规则

## 测试文件命名规则
- 测试类名应该与被测试的类名相对应，以Test结尾
- 测试文件应该放在与源文件相对应的测试目录结构中

## 需要测试的类型
1. Repository实现类
   - 测试所有数据库操作方法
   - 验证查询条件和结果
   - 测试事务行为

2. Service实现类
   - 测试业务逻辑
   - 验证参数校验
   - 测试异常处理
   - 验证依赖注入和协作

3. Controller实现类
   - 测试API端点
   - 验证请求参数处理
   - 测试响应状态和格式
   - 验证权限和认证

## 不需要测试的内容
1. 接口定义文件
2. 常量类
3. 枚举类
4. 工具类中的简单方法
5. 配置类
6. DTO/VO/PO等模型类

## 测试覆盖要求
1. 主要业务流程必须有测试覆盖
2. 异常分支必须有测试覆盖
3. 边界条件必须有测试覆盖

## 测试方法命名规则
方法名应该清晰地表达：
- 被测试的方法
- 测试场景
- 预期结果
例如：methodName_scenario_expectedResult

## Mock使用规则
1. 外部依赖应该被mock
2. 数据库操作应该使用内存数据库或mock
3. 避免不必要的mock，保持测试的真实性

## 测试数据管理
1. 使用@BeforeEach准备测试数据
2. 测试数据应该具有代表性
3. 避免测试间数据依赖

## 断言规则
1. 每个测试方法至少包含一个断言
2. 使用恰当的断言方法
3. 提供有意义的错误消息

## 测试隔离
1. 测试方法之间保持独立
2. 避免测试顺序依赖
3. 每个测试结束后清理测试数据 